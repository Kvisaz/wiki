# Phaser 3 - Текстуры

[<------------ Индекс ](../README.md)

В основе картинок и спрайтов лежат текстуры. Когда мы говорим фазеру загрузить картинку - на самом деле мы говорим "создай нам текстуру с таким-то именем и из такого url"

```javascript
// внутри scene
// textureName - имя текстуры
// picUrl - откуда загрузить
this.load.image(textureName, picUrl);
```

А затем, когда мы создаем спрайт или картинку, мы как бы говорим "сделай нам игровой объект на базе текстуры с таким именем"

```javascript
// внутри scene
// первые два параметра - координаты картинки
this.add.image(0, 0, textureName);
```

Итак, текстура - это и есть настоящая картинка, то, что лежит в основе. Phaser может распилить её на части с помощью фреймов.

[Фреймы](Frame.md) могут пригодиться для создания паззлов. 

## [Фреймы текстуры](Frame.md)
Можно брать только кусочек текстуры - "фрейм". По умолчанию в каждой текстуре создаетс фрейм с именем `__BASE`. Он включает в себя всю текстуру, все её размеры.

Да, фреймы могут пересекаться! В одной текстуре можно создать кучу пересекающихся фреймов, если нужно. Главное, выполнять правила
- фреймы должны иметь уникальные имена внутри текстуры
- если добавить фрейм с уже имеющимся именем, он сотрет старый
- если не указывать имя фрейма при создании игрового объекта - будет взять первый фрейм

Чтобы добавить фрейм, нужно обратиться к текстуре через TextureManager или через игровой объект, на базе которого он создан. 

```javascript
// допустим мы создали игровой объект
const image = this.add.image(0, 0, textureName);
const texture = image.texture; // это его текстура

// или мы еще ничего не создали, обращаемся к TextureManager
const texture = this.textures.get(textureName);

// теперь мы можем добавить фрейм
// имя фрейма, x, y, width, height
texture.add('myFrame', 0, 0, 32, 32);
```

Внимание - если в текстуре появляются фреймы, все  `this.add.image` будут использовать первый попавшийся фрейм, а не `__BASE`.
Поэтому при использовании текстуры надо либо всегда указывать имя фрейма, либо не баловаться с фреймами вообще )

```javascript
// вот такая запись гарантирует, что картинка будет использоватью всю текстуру, 
// даже если мы добавим новые фреймы
this.add.image(0, 0, textureName, '__BASE')
```

## Откуда можно получить текстуры в Phaser

### Загрузка из файла
Самый распространенный и простой способ - загрузить текстуру из сети или ассетов игры, указав url в loader.  Текстура будет создана после удачной загрузки. 

```javascript
// внутри scene, к примеру, в preloader - но можно вообще где угодно
// textureName - имя текстуры
// picUrl - откуда загрузить
this.load.image(textureName, picUrl);
```

### Динамическая текстура из canvas
Второй способ - создать текстуру из canvas. Такая текстура будет автоматически обновляться, когда мы что-то нарисуем на канвасе. Это можно сделать с помощью метода createCanvas у TextureManager, который доступен в сцене, как textures 

```javascript
const TEXTURE_NAME = 'myCanvasTexture';
const textureWidth = 256;
const textureHeight = 256;

const canvasTexture = this.textures.createCanvas(TEXTURE_NAME, textureWidth, textureHeight);
const image = this.add.image(0, 0, TEXTURE_NAME);
```

Теперь, что бы мы не нарисовали на canvas - это автоматически появится в созданном игровом объекте `image`. 

```javascript
canvasTexture.context.fillStyle = grd;
canvasTexture.context.fillRect(0, 0, 16, 256);
canvasTexture.refresh(); // это обязательно нужно, чтобы в WebGL обновленная текстура снова попала в работу
```

[<------------ Индекс ](../README.md)

